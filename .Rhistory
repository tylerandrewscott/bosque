tab_temp$bin_Wholesaler<-as.factor(ifelse(tab_temp$bin_Wholesaler==1,'yes','no'))
library(gt)
library(labelled)
names(tab_temp) <- replace_summary_df$new[match(names(tab_temp),replace_summary_df$old)]
facts <- c('Wholesaler','Primary groundwater')
tab_temp <- cbind(tab_temp %>% select(-contains('ln(')),
tab_temp %>% select(contains('ln(')) %>% mutate_all(exp))
tab_temp2 <- tab_temp[,sum_order,with = F]
library(vtable)
names(tab_temp2)<-str_remove_all(names(tab_temp2),'ln\\(|\\)')
sumtable(tab_temp2 ,file = 'org_performance/output/table1.html',
summ = c('mean(x)','median(x)','sd(x)','min(x)','max(x)'))
#
# #tab_temp$home_value_quartile <- ntile(tab_temp$`ln(median home value)`,4)
# vmins2 <- readRDS('org_performance/output/individual_violation_durations.RDS')
# id_crosswalk <- readRDS('org_performance/output/id_crosswalk.RDS')
# vmins2$District_ID <- id_crosswalk$District_ID[match(vmins2$PWSID,id_crosswalk$PWS_ID)]
# vmins2 <- vmins2[!is.na(District_ID),]
# vmins2 <- vmins2[YEAR %in% 2007:2022.]
# vmins2$median_home_value <- tab_temp$`ln(median home value)`[match(paste(vmins2$District_ID,vmins2$YEAR),paste(tab_temp$District_ID,tab_temp$YEAR))]
# tab_temp$home_quartile <- ntile(tab_temp$`ln(median home value)`,2)
# vls <- quantile(tab_temp$`ln(median home value)`,c(0,0.5,1))
# vmins2$home_quartile <- cut(vmins2$median_home_value,breaks = vls,labels = c(1:2),include.lowest = F)
#
# vvals <- vmins2[!is.na(home_quartile),list(.N,mean(end-start)),by = .(IS_HEALTH_BASED_IND,home_quartile)]
# setnames(vvals,c('N','V2'),c('# unique violations','Avg. duration of non-compliance'))
# vvals2 <- dcast(vvals,home_quartile ~ IS_HEALTH_BASED_IND,value.var = c('# unique violations','Avg. duration of non-compliance'))
# num_by_quart <- tab_temp[,.N,by=.(home_quartile)][order(home_quartile),]
# vvals2$num_system_year_obs <- num_by_quart$N[match(vvals2$home_quartile,num_by_quart$home_quartile)]
#panel_structure <- "as.factor(District_ID) + as.factor(YEAR) + as.factor(CBSA_CFIPS)"
#panel_structure_alt <- "f(District_ID,model = 'iid') + f(YEAR,model = 'iid') + f(CBSA_FIPS,model = 'iid')"
mod_temp <- temp[,grep('^std|^bin|violator|^YEAR$|^MASTER_ID$|DROP',names(temp),value = T),with = F]
#mod_temp$MASTER_ID<-paste0('ID',mod_temp$MASTER_ID)
#mod_temp$YEAR <- paste0('Y',mod_temp$YEAR)
mod_temp$YEAR_ID <- as.numeric(as.factor(mod_temp$YEAR))
mod_temp$MASTER_GROUP_NUM <- as.numeric(as.factor(mod_temp$MASTER_ID))
u = 1
f1 <- management_violator ~ f(YEAR_ID,model = 'iid') + f(MASTER_GROUP_NUM,model = 'iid')
f2 <- health_violator ~ f(YEAR_ID,model = 'iid') + f(MASTER_GROUP_NUM,model = 'iid')
f3 <- management_violator ~ f(YEAR_ID,model = 'iid') + f(MASTER_GROUP_NUM,model = 'iid') +
std_ln_REV_PER_CONNECTION_L1 +
std_ln_FUND_BALANCE_L1 +
std_ln_DEBT_OUTSTANDING_PER_CONNECTION_L1 +
std_Prop_Bach + std_Median_Structure_Age + std_ln_MEDIAN_HOME_VALUE +
std_NUM_PWS_CBSA + std_CBSA_HHI +
std_ln_SERVICE_CONNECTIONS_COUNT + bin_Groundwater + bin_Wholesaler +
std_Severe_Weather_Events +  std_DSCI_1yr_Weekly_Avg +
management_violator_L1
f4 <- health_violator ~ f(YEAR_ID,model = 'iid') + f(MASTER_GROUP_NUM,model = 'iid') +
std_ln_REV_PER_CONNECTION_L1 +
std_ln_FUND_BALANCE_L1 +
std_ln_DEBT_OUTSTANDING_PER_CONNECTION_L1 +
std_Prop_Bach + std_Median_Structure_Age + std_ln_MEDIAN_HOME_VALUE +
std_NUM_PWS_CBSA + std_CBSA_HHI +
std_ln_SERVICE_CONNECTIONS_COUNT + bin_Groundwater + bin_Wholesaler +
std_Severe_Weather_Events +  std_DSCI_1yr_Weekly_Avg +
health_violator_L1
m1_pre <- inla(f1,family = "binomial", Ntrials = 1,data = mod_temp,verbose = T)
m2_pre <- inla(f2,family = "binomial", Ntrials = 1,data = mod_temp,verbose = T)
dim(mod_temp[!(mod_temp$DROP_FROM_FULL_MODEL|mod_temp$DROP_FROM_PANEL|mod_temp$DROP_YEAR_FROM_MODEL),])
m1 <- inla(f1,family = "binomial",
control.mode = list(theta = m1_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
m2 <- inla(f2,family = "binomial",
control.mode = list(theta = m2_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
m3 <- inla(f3,family = "binomial",
control.mode = list(theta = m1_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
m4 <- inla(f4,family = "binomial",
control.mode = list(theta = m2_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
coefs<-rbind(
m3$summary.fixed[,c(1,3,5)] %>% mutate(Coef = rownames(.),Noncompliance = 'Management') %>% filter(!grepl('factor',Coef)),
m4$summary.fixed[,c(1,3,5)] %>% mutate(Coef = rownames(.),Noncompliance = 'Health') %>% filter(!grepl('factor',Coef))
)
library(forcats)
replace_df <- data.frame(old = c("std_ln_REV_PER_CONNECTION_L1","std_ln_FUND_BALANCE_L1","std_ln_DEBT_OUTSTANDING_PER_CONNECTION_L1",
"std_Prop_Bach","std_Median_Structure_Age","std_ln_MEDIAN_HOME_VALUE",
"std_NUM_PWS_CBSA","std_CBSA_HHI","std_ln_SERVICE_CONNECTIONS_COUNT","bin_Groundwater","bin_Wholesaler",
"std_Severe_Weather_Events","std_DSCI_1yr_Weekly_Avg","health_violator_L1","management_violator_L1"),
new = c('ln(revenue/connection),t-1','ln(fund balance),t-1','ln(debt/connection),t-1',
"% bachelor's degree","median structure age",'ln(median home value)',
'# PWS in CBSA','HHI for CBSA','ln(service connections)','Primary groundwater','Wholesaler',
'# weather events, t','Weekly drought avg., t','health violator, t-1',
'management violator, t-1')
)
coefs$Coef[coefs$Coef %in% replace_df$old]<-replace_df$new[match(coefs$Coef[coefs$Coef %in% replace_df$old],replace_df$old)]
library(htmlTable)
rownames(coefs)<-1:nrow(coefs)
coefs$mean<-round(coefs$mean,3)
coefs$`0.025quant`<-round(coefs$`0.025quant`,3)
coefs$`0.975quant`<-round(coefs$`0.975quant`,3)
coefs$total_coef <- paste0(coefs$mean,' (',coefs$`0.025quant`,",",coefs$`0.975quant`,")")
coefs$total_coef<-paste0(coefs$total_coef,ifelse(coefs$`0.025quant`<0&coefs$`0.975quant`>0,"","*"))
coefs<-data.table(coefs)
tab_order<-c("(Intercept)" ,
"health violator, t-1",
"management violator, t-1",
"# PWS in CBSA" ,
"HHI for CBSA" ,
"# weather events, t" ,
"Weekly drought avg., t",
"ln(median home value)",
"% bachelor's degree",
"ln(service connections)" ,
"median structure age" ,
"ln(debt/connection),t-1",
"ln(revenue/connection),t-1" ,
"ln(fund balance),t-1")
big_tab <- dcast(coefs,Coef~Noncompliance,value.var = 'total_coef')
big_tab <- big_tab[match(tab_order,big_tab$Coef),]
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,4),
tfoot = "*95% credible interval does not include 0\n^all continuous predictors are mean-centered and scaled",
rgroup = c('','Prior performance','Complexity: competition and density','Control variables: context','Control variables: water district')
)
big_tab
coefs
ggplot(coefs) + geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`))
ggplot(coefs) + geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef))
ggplot(coefs) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef)) +
theme_bw()
ggplot(coefs) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw()
ggplot(coefs) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind()
ggplot(coefs) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'test')
ggplot(coefs) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type')
ggplot(coefs) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
match(tab_order,big_tab$Coef)
coefs$ORDER <- match(tab_order,big_tab$Coef)
tab_order
coefs
coefs$ORDER <- match(tab_order,big_tab$Coef)
coefs$Coef
coefs$ORDER <- match(tab_order,coefs$Coef)
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
tab_order
coefs$ORDER <- match(coefs$Coef,tab_order)
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = ORDER,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = as.factor(ORDER),col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
big_tag
big_tab
m3$waic$waic
?control.compute
m4 <- inla(f4,family = "binomial",control.compute = list(waic = T,dic = T,mlik = T),
control.mode = list(theta = m2_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
m1 <- inla(f1,family = "binomial", control.compute = list(waic = T,dic = T,mlik = T),
control.mode = list(theta = m1_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
m2 <- inla(f2,family = "binomial", control.compute = list(waic = T,dic = T,mlik = T),
control.mode = list(theta = m2_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
m3 <- inla(f3,family = "binomial", control.compute = list(waic = T,dic = T,mlik = T),
control.mode = list(theta = m1_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
m4 <- inla(f4,family = "binomial",control.compute = list(waic = T,dic = T,mlik = T),
control.mode = list(theta = m2_pre$mode$theta) ,
Ntrials = 1,data = mod_temp[!mod_temp$DROP_FROM_FULL_MODEL,],verbose = T)
m3$waic$waic
m4$waic$waic
cbind(m3$waic$waic,m4$waic$waic)
cbind(m3$dic$dic,m4$dic$dic)
m3$mlik
m3$mlik[1]
do.call(rbind,list(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)))
cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic))))
cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(rbind(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic),2))))
cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(round(rbind(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)),2))))
big_tab
rbind(big_tab,
cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(round(rbind(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)),2))))
)
big_tab
data.table(cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(round(rbind(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)),2)))))
rbind(big_tab,
data.table(cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(round(rbind(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)),2))))),
use.names = F)
big_tab <- rbind(big_tab,
data.table(cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(round(rbind(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)),2))))),
use.names = F)
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,4,3),
tfoot = "*95% credible interval does not include 0\n
^all continuous predictors are mean-centered and scaled",
rgroup = c('','Prior performance',
'Complexity: competition and density',
'Control variables: context',
'Control variables: water district',
'Model fit statistics')
)
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,4,3),
tfoot = "*95% credible interval does not include 0
^all continuous predictors are mean-centered and scaled",
rgroup = c('','Prior performance',
'Complexity: competition and density',
'Control variables: context',
'Control variables: water district',
'Model fit statistics')
)
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,5,3),
tfoot = "*95% credible interval does not include 0
^all continuous predictors are mean-centered and scaled
^^",
rgroup = c('','Prior performance',
'Complexity: competition and density',
'Control variables: context',
'Control variables: water district',
'Model fit statistics')
)
tab_order<-c("(Intercept)" ,
"health violator, t-1",
"management violator, t-1",
"# PWS in CBSA" ,
"HHI for CBSA" ,
"# weather events, t" ,
"Weekly drought avg., t",
"ln(median home value)",
"% bachelor's degree",
"ln(service connections)" ,
"median structure age" ,
"ln(debt/connection),t-1",
"ln(revenue/connection),t-1" ,
"ln(fund balance),t-1",
'Wholesaler','Groundwater')
big_tab <- dcast(coefs,Coef~Noncompliance,value.var = 'total_coef')
big_tab <- big_tab[match(tab_order,big_tab$Coef),]
big_tab <- rbind(big_tab,
data.table(cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(round(rbind(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)),2))))),
use.names = F)
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,5,3),
tfoot = "*95% credible interval does not include 0
^all continuous predictors are mean-centered and scaled
^^",
rgroup = c('','Prior performance',
'Complexity: competition and density',
'Control variables: context',
'Control variables: water district',
'Model fit statistics')
)
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,7,3),
tfoot = "*95% credible interval does not include 0
^all continuous predictors are mean-centered and scaled
^^",
rgroup = c('','Prior performance',
'Complexity: competition and density',
'Control variables: context',
'Control variables: water district',
'Model fit statistics')
)
tab_order<-c("(Intercept)" ,
"health violator, t-1",
"management violator, t-1",
"# PWS in CBSA" ,
"HHI for CBSA" ,
"# weather events, t" ,
"Weekly drought avg., t",
"ln(median home value)",
"% bachelor's degree",
"ln(service connections)" ,
'Wholesaler','Primary groundwater',
"median structure age" ,
"ln(debt/connection),t-1",
"ln(revenue/connection),t-1" ,
"ln(fund balance),t-1")
big_tab <- dcast(coefs,Coef~Noncompliance,value.var = 'total_coef')
big_tab <- big_tab[match(tab_order,big_tab$Coef),]
big_tab <- rbind(big_tab,
data.table(cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(round(rbind(cbind(m3$mlik[1],m3$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)),2))))),
use.names = F)
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,7,3),
tfoot = "*95% credible interval does not include 0
^all continuous predictors are mean-centered and scaled
^^",
rgroup = c('','Prior performance',
'Complexity: competition and density',
'Control variables: context',
'Control variables: water district',
'Model fit statistics')
)
big_tab <- dcast(coefs,Coef~Noncompliance,value.var = 'total_coef')
big_tab <- big_tab[match(tab_order,big_tab$Coef),]
big_tab <- rbind(big_tab,
data.table(cbind(c('LL','DIC','WAIC'),
do.call(rbind,list(round(rbind(cbind(m3$mlik[1],m4$mlik[2]),
cbind(m3$dic$dic,m4$dic$dic),
cbind(m3$waic$waic,m4$waic$waic)),2))))),
use.names = F)
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,7,3),
tfoot = "*95% credible interval does not include 0
^all continuous predictors are mean-centered and scaled
^^",
rgroup = c('','Prior performance',
'Complexity: competition and density',
'Control variables: context',
'Control variables: water district',
'Model fit statistics')
)
htmlTable(big_tab,rnames = F,file = 'org_performance/output/table2.html',
n.cgroup = c(1,2),
cgroup = c("",'Violation occurence'),
#  header = c("","health regulations","management regulations"),
n.rgroup = c(1,2,2,4,7,3),
tfoot = "*95% credible interval does not include 0
^all continuous predictors are mean-centered and scaled
^^LL = log-likelihood; DIC = deviance information criterion; WAIC = Watanabe–Akaike information criterion",
rgroup = c('','Prior performance',
'Complexity: competition and density',
'Control variables: context',
'Control variables: water district',
'Model fit statistics')
)
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
match(coefs$Coef,rev(tab_order))
coefs$ORDER <- match(coefs$Coef,rev(tab_order))
library(forcats)
fct_reorder(coefs$Coef,coefs$ORDER)
coefs$ORDER
coefs$Coef
coefs$ORDER <- match(coefs$Coef,tab_order)
fct_reorder(coefs$Coef,coefs$ORDER)
coefs
coefs[coefs$ORDER,]
ggplot(coefs[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
coefs$Coef <- fct_recode(coefs$Coef,tab_order)
tab_order
coefs2 <- coefs[!grepl("Intercept",Coef),]
coefs2$Coef <- fct_recode(coefs2$Coef,tab_order)
coefs2
tab_order
?fct_recode
coefs2 <- coefs[!grepl("Intercept",Coef),]
coefs2$Coef <- fct_relevel(coefs2$Coef,tab_order)
tab_order
coefs2 <- coefs
coefs2$Coef <- fct_relevel(coefs2$Coef,tab_order)
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
coefs2$Coef <- fct_rev(coefs2$Coef)
library(forcats)
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,col = Noncompliance)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
coefs2
coefs2$SIG <- ifelse(coefs2$`0.025quant`<0&coefs2$`0.975quant`>0,0,1)
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,col = Noncompliance,alpha = SIG)) +
theme_bw() + scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,col = Noncompliance,alpha = SIG)) +
theme_bw() +
scale_alpha_discrete(values = c(0,1))+
scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
?scale_alpha_discrete
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,col = Noncompliance,alpha = SIG)) +
theme_bw() +
scale_alpha(values = range(0,1))+
scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,col = Noncompliance,alpha = SIG)) +
theme_bw() +
scale_alpha(range = c(0,1))+
scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,fill = SIG,col = Noncompliance,alpha = SIG)) +
theme_bw() +
# scale_fill_manual()+
scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,fill = as.factor(SIG),col = Noncompliance,alpha = SIG)) +
theme_bw() +
scale_fill_manual()
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,fill = as.factor(SIG),col = Noncompliance,alpha = SIG)) +
theme_bw() +
scale_fill_manual(values = c('red','blue'))+
scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
ggplot(coefs2[!grepl("Intercept",Coef),]) +
geom_errorbarh(aes(xmin = `0.025quant`,xmax = `0.975quant`,y = Coef,col=Noncompliance)) +
geom_point(aes(x = mean,y = Coef,fill = as.factor(SIG),col = Noncompliance,alpha = SIG)) +
theme_bw() +
scale_fill_manual(values = c('white','black'))+
scale_colour_colorblind(name = 'Violation type') +
theme(legend.position = c(0.8,0.2))
